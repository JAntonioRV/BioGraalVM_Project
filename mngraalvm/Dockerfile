# use graalvm image
# replace the occurences of "mngraalvm" with you jar name
FROM jantoniorv/graalvm-ce:20.3.0-java8

# expose your port, 8080 fo Micronaut applicatoin
EXPOSE 8080

# copy the fat jar
COPY build/libs/*-all.jar mngraalvm.jar

# create the reflection configuration file generated by Micronaut
# for other frameworks you need to construct the file yourself
ADD . build

# Installs native-image if it not exists
RUN gu install native-image

#Installs python language
RUN gu install python

# run the native image compiler, you should already know the command arguments
# if you're not running micronaut
RUN native-image --no-server --language:python --class-path mngraalvm.jar

# the native command will be used to run the application
CMD ./mngraalvm
